# Comply-Intel Configuration
# ===========================
# This file tells the GRC Agent Factory which checks to run and how.
# Run with: ./comply-intel --config config.yaml --report

# Path to the directory containing agent packs
packs_dir: "./packs"

# Schedule: "once" for a single scan, "every 1h" for interval, or cron "0 2 * * *"
schedule: "once"

# Number of checks to run in parallel
concurrency: 8

# Timeout per check script
timeout: "120s"

# Output configuration
output:
  format: "table"   # "json", "table", or "csv"
  target: "stdout"   # "stdout" or "file"
  # path: "./results/scan-output.json"  # required when target is "file"

# Credentials injected as environment variables into agent scripts.
# SECURITY: For production, use a secrets manager and inject at runtime.
# These values are passed via env vars, never on the command line.
credentials:
  # AWS_ACCESS_KEY_ID: "YOUR_KEY_HERE"
  # AWS_SECRET_ACCESS_KEY: "YOUR_SECRET_HERE"
  # AWS_REGION: "us-east-1"
  # GITHUB_TOKEN: "ghp_your_token_here"

# =====================================================================
# Checks to execute
# Each entry references a pack name and a check ID from that pack.
# =====================================================================
checks:

  # ===========================================
  # LINUX HARDENING (runs without credentials)
  # ===========================================
  - pack: linux
    check: password-policy
    params:
      min_length: "14"
      max_days: "90"

  - pack: linux
    check: ssh-config

  - pack: linux
    check: file-permissions

  - pack: linux
    check: firewall-status

  - pack: linux
    check: audit-logging

  - pack: linux
    check: unnecessary-services

  - pack: linux
    check: kernel-hardening

  - pack: linux
    check: filesystem-encryption

  - pack: linux
    check: user-accounts

  - pack: linux
    check: cron-permissions

  # ===========================================
  # AWS SECURITY
  # Uncomment after setting AWS credentials
  # ===========================================
  # --- S3 ---
  # - pack: aws
  #   check: s3-encryption
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: s3-public-access
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: s3-versioning
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: s3-logging
  #   params:
  #     region: "us-east-1"
  # --- IAM ---
  # - pack: aws
  #   check: iam-password-policy
  # - pack: aws
  #   check: iam-mfa-enabled
  # - pack: aws
  #   check: iam-root-mfa
  # - pack: aws
  #   check: iam-unused-credentials
  #   params:
  #     max_age_days: "90"
  # - pack: aws
  #   check: iam-access-key-rotation
  #   params:
  #     max_age_days: "90"
  # --- CloudTrail ---
  # - pack: aws
  #   check: cloudtrail-enabled
  # - pack: aws
  #   check: cloudtrail-log-validation
  # --- Security Groups ---
  # - pack: aws
  #   check: sg-unrestricted-ssh
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: sg-unrestricted-rdp
  #   params:
  #     region: "us-east-1"
  # --- EBS / RDS ---
  # - pack: aws
  #   check: ebs-encryption
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: rds-encryption
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: rds-public-access
  #   params:
  #     region: "us-east-1"
  # - pack: aws
  #   check: rds-backup-enabled
  #   params:
  #     region: "us-east-1"

  # ===========================================
  # GITHUB SECURITY
  # Uncomment after setting GITHUB_TOKEN
  # ===========================================
  # - pack: github
  #   check: branch-protection
  #   params:
  #     org: "your-org-name"
  # - pack: github
  #   check: secret-scanning
  #   params:
  #     org: "your-org-name"
  # - pack: github
  #   check: dependabot-alerts
  #   params:
  #     org: "your-org-name"
  # - pack: github
  #   check: org-2fa
  #   params:
  #     org: "your-org-name"
  # - pack: github
  #   check: repo-visibility
  #   params:
  #     org: "your-org-name"
  # - pack: github
  #   check: actions-security
  #   params:
  #     org: "your-org-name"

  # ===========================================
  # NETWORK SECURITY
  # Uncomment and set target hosts/URLs
  # ===========================================
  # - pack: network
  #   check: tls-config
  #   params:
  #     targets: "example.com:443"
  # - pack: network
  #   check: open-ports
  #   params:
  #     targets: "192.168.1.1"
  #     allowed_ports: "22,80,443"
  # - pack: network
  #   check: dns-security
  #   params:
  #     domains: "example.com"
  # - pack: network
  #   check: http-headers
  #   params:
  #     targets: "https://example.com"
  # - pack: network
  #   check: certificate-expiry
  #   params:
  #     targets: "example.com:443"
  #     warn_days: "30"

  # ===========================================
  # DOCKER / CONTAINER SECURITY
  # Uncomment if Docker is installed
  # ===========================================
  # - pack: docker
  #   check: docker-daemon-config
  # - pack: docker
  #   check: container-privileges
  # - pack: docker
  #   check: image-vulnerabilities
  # - pack: docker
  #   check: container-networking
  # - pack: docker
  #   check: docker-logging
  # - pack: docker
  #   check: docker-resource-limits
